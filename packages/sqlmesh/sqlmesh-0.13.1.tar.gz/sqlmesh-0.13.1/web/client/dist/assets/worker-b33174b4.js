(function(){"use strict";importScripts("https://cdn.jsdelivr.net/pyodide/v0.22.1/full/pyodide.js");const a=self;async function c(){a.pyodide=await a.loadPyodide(),await a.pyodide.loadPackage("micropip"),await a.pyodide.pyimport("micropip").install("sqlglot");const d=await(await fetch(new URL("data:application/octet-stream;base64,aW1wb3J0IGpzb24KCmltcG9ydCBzcWxnbG90CmZyb20gc3FsZ2xvdCBpbXBvcnQgZXhwCmZyb20gc3FsZ2xvdC5kaWFsZWN0cy5kaWFsZWN0IGltcG9ydCBEaWFsZWN0LCBEaWFsZWN0VHlwZQoKZGlhbGVjdHMgPSBqc29uLmR1bXBzKAogICAgWwogICAgICAgIHsKICAgICAgICAgICAgImRpYWxlY3RfdGl0bGUiOiAiU1FMR2xvdCIgaWYgZGlhbGVjdCA9PSAiIiBlbHNlIGRpYWxlY3RfY2xhc3MuX19uYW1lX18sCiAgICAgICAgICAgICJkaWFsZWN0X25hbWUiOiBkaWFsZWN0LAogICAgICAgIH0KICAgICAgICBmb3IgZGlhbGVjdCwgZGlhbGVjdF9jbGFzcyBpbiBEaWFsZWN0LmNsYXNzZXMuaXRlbXMoKQogICAgXQopCgoKZGVmIHBhcnNlX3RvX2pzb24oc3FsOiBzdHIsIHJlYWQ6IERpYWxlY3RUeXBlID0gTm9uZSkgLT4gc3RyOgogICAgcmV0dXJuIGpzb24uZHVtcHMoCiAgICAgICAgW2V4cC5kdW1wKCkgaWYgZXhwIGVsc2Uge30gZm9yIGV4cCBpbiBzcWxnbG90LnBhcnNlKHNxbCwgcmVhZD1yZWFkLCBlcnJvcl9sZXZlbD0iaWdub3JlIildCiAgICApCgoKZGVmIGdldF9kaWFsZWN0KG5hbWU6IHN0ciA9ICIiKSAtPiBzdHI6CiAgICBkaWFsZWN0ID0gRGlhbGVjdC5jbGFzc2VzLmdldChuYW1lLCBEaWFsZWN0KQogICAgdG9rZW5pemVyID0gZGlhbGVjdC50b2tlbml6ZXJfY2xhc3MKICAgIG91dHB1dCA9IHsia2V5d29yZHMiOiAiIiwgInR5cGVzIjogIiJ9CgogICAgaWYgdG9rZW5pemVyIGlzIG5vdCBOb25lIGFuZCBkaWFsZWN0LmdlbmVyYXRvcl9jbGFzcyBpcyBub3QgTm9uZToKICAgICAgICB0eXBlX21hcHBpbmcgPSBkaWFsZWN0LmdlbmVyYXRvcl9jbGFzcy5UWVBFX01BUFBJTkcKCiAgICAgICAgb3V0cHV0ID0gewogICAgICAgICAgICAia2V5d29yZHMiOiAiICIuam9pbih0b2tlbml6ZXIuS0VZV09SRFMpICsgIiAiLAogICAgICAgICAgICAidHlwZXMiOiAiICIuam9pbih0eXBlX21hcHBpbmcuZ2V0KHQsIHQudmFsdWUpIGZvciB0IGluIGV4cC5EYXRhVHlwZS5UeXBlKSArICIgIiwKICAgICAgICB9CgogICAgcmV0dXJuIGpzb24uZHVtcHMob3V0cHV0KQoKCltwYXJzZV90b19qc29uLCBnZXRfZGlhbGVjdCwgZGlhbGVjdHNdCg==",self.location))).text();return a.postMessage({topic:"init"}),Array.from(a.pyodide.runPython(d))}const C=c();a.onmessage=async i=>{const[d,l,o]=await C;if(i.data.topic==="validate"){let g;try{const I=JSON.parse(d(i.data.payload)).filter(Boolean);g=!!I&&I.length>0}catch{g=!1}a.postMessage({topic:"validate",payload:g})}if(i.data.topic==="dialect"){const{keywords:g,types:I}=JSON.parse(l(i.data.payload));a.postMessage({topic:"dialect",payload:{types:`${I} `.toLowerCase(),keywords:`${g} `.toLowerCase()}})}i.data.topic==="dialects"&&a.postMessage({topic:"dialects",payload:{dialects:JSON.parse(o),dialect:"mysql"}})}})();
