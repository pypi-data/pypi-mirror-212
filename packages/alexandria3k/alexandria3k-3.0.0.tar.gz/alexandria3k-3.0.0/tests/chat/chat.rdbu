BEGIN SETUP
relationships:
id	parent_id
1	2
2	3
3 	null
END

BEGIN SELECT
WITH RECURSIVE cte AS (
  SELECT id, parent_id
  FROM relationships
  WHERE parent_id IS NULL
  UNION ALL
  SELECT relationships.id, relationships.parent_id
  FROM relationships
  INNER JOIN cte ON relationships.parent_id = cte.id
)
SELECT id, parent_id
FROM cte;
END

BEGIN RESULT
id	parent_id
1	3
2	3
3	null
END
