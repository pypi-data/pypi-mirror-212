syntax = "proto3";

package calixa.domain.customentity;

import "google/protobuf/timestamp.proto";
import "common.proto";

import "oltpannotation.proto";

option java_multiple_files = true;
option optimize_for = SPEED;
option java_package = "io.calixa.domain.customentity";

message CustomEntity {
  string custom_entity_definition_id = 1;
  string external_id = 2;
  repeated string api_account_ids = 3;
  repeated string api_user_ids = 4;

  map<string, CustomEntityFieldValue> values = 5;
}

message CustomEntityDefinition {
  option (calixa.oltp.oltp_primary_key) = {field_ids: [10, 11]};

  string organization_id = 10;
  string id = 11;

  string name = 1;
  string description = 2 [(calixa.oltp.oltp_field) = {nullable: true}];
  string slug = 3;
  repeated CustomEntityDefinitionField fields = 4 [(calixa.oltp.oltp_field) = {nullable: false}];
  string created_by_user_id = 5;

  google.protobuf.Timestamp created_at = 12 [(calixa.oltp.oltp_field) = {nullable: false}];
  google.protobuf.Timestamp updated_at = 13 [(calixa.oltp.oltp_field) = {nullable: false}];
  google.protobuf.Timestamp deleted_at = 14 [(calixa.oltp.oltp_field) = {nullable: true}];
}

message CustomEntityDefinitionField {
  string field_name = 1;
  CustomEntityDefinitionFieldType field_type = 2;
  bool required = 3;
}

message CustomEntityFieldValue {
  oneof value {
    string string = 1;
    int64 long = 2;
    double double = 3;
    bool bool = 4;
    google.protobuf.Timestamp timestamp = 5;
  }
}

enum CustomEntityDefinitionFieldType {
  CUSTOM_ENTITY_DEFINITION_FIELD_TYPE_UNSPECIFIED = 0;
  CUSTOM_ENTITY_DEFINITION_FIELD_TYPE_STRING = 1;
  CUSTOM_ENTITY_DEFINITION_FIELD_TYPE_LONG = 2;
  CUSTOM_ENTITY_DEFINITION_FIELD_TYPE_DOUBLE = 3;
  CUSTOM_ENTITY_DEFINITION_FIELD_TYPE_BOOLEAN = 4;
  CUSTOM_ENTITY_DEFINITION_FIELD_TYPE_TIMESTAMP = 5;
}

